#include <stdio.h>
#include <math.h>
#include "../vector.h"
#include "t_util.h"

struct nega_test {
  float va[4];
  float vr[4];
  unsigned int sz;
};

struct nega_test tests[] = {
  /* tools/nega_gen.c */
  {
    {0.000000, 0.000000, 0.000000, 0.000000},
    {-0.000000, -0.000000, -0.000000, -0.000000},
    4,
  },
  {
    {-19.328571, -0.921925, 0.000000, 0.000000},
    {19.328571, 0.921925, -0.000000, -0.000000},
    2,
  },
  {
    {5.831081, 9.400000, 0.000000, 0.000000},
    {-5.831081, -9.400000, -0.000000, -0.000000},
    2,
  },
  {
    {-2.914980, 15.959302, 0.000000, 0.000000},
    {2.914980, -15.959302, -0.000000, -0.000000},
    2,
  },
  {
    {-5.046576, 3.997658, 0.000000, 0.000000},
    {5.046576, -3.997658, -0.000000, -0.000000},
    2,
  },
  {
    {-6.030726, 2.470709, 0.000000, 0.000000},
    {6.030726, -2.470709, -0.000000, -0.000000},
    2,
  },
  {
    {-65.435486, 9.268042, 0.000000, 0.000000},
    {65.435486, -9.268042, -0.000000, -0.000000},
    2,
  },
  {
    {74.515152, -8.019960, 0.000000, 0.000000},
    {-74.515152, 8.019960, -0.000000, -0.000000},
    2,
  },
  {
    {13.233767, -4.427873, 0.000000, 0.000000},
    {-13.233767, 4.427873, -0.000000, -0.000000},
    2,
  },
  {
    {36.223682, 5.031070, 0.000000, 0.000000},
    {-36.223682, -5.031070, -0.000000, -0.000000},
    2,
  },
  {
    {-8.575000, 0.661663, 26.815790, 0.000000},
    {8.575000, -0.661663, -26.815790, -0.000000},
    3,
  },
  {
    {-4.786567, -24.888325, 4.530000, 0.000000},
    {4.786567, 24.888325, -4.530000, -0.000000},
    3,
  },
  {
    {36.839695, -7.185351, 1.455137, 0.000000},
    {-36.839695, 7.185351, -1.455137, -0.000000},
    3,
  },
  {
    {34.293480, 1.634948, -12.854014, 0.000000},
    {-34.293480, -1.634948, 12.854014, -0.000000},
    3,
  },
  {
    {10.577540, -7.374392, -35.442623, 0.000000},
    {-10.577540, 7.374392, 35.442623, -0.000000},
    3,
  },
  {
    {-6.362069, 27.567568, -5.927873, 0.000000},
    {6.362069, -27.567568, 5.927873, -0.000000},
    3,
  },
  {
    {1.132251, 2.097458, 1.917823, 0.000000},
    {-1.132251, -2.097458, -1.917823, -0.000000},
    3,
  },
  {
    {16.608164, 0.426966, 3.895766, 0.000000},
    {-16.608164, -0.426966, -3.895766, -0.000000},
    3,
  },
  {
    {7.945455, -4.097887, -990.750000, 0.000000},
    {-7.945455, 4.097887, 990.750000, -0.000000},
    3,
  },
  {
    {0.681081, 1.518841, 24.477777, 0.000000},
    {-0.681081, -1.518841, -24.477777, -0.000000},
    3,
  },
  {
    {-0.807163, 11.456667, 5.512718, 3.755319},
    {0.807163, -11.456667, -5.512718, -3.755319},
    4,
  },
  {
    {-1.838373, -4.125490, 32.558823, 5.227129},
    {1.838373, 4.125490, -32.558823, -5.227129},
    4,
  },
  {
    {-2.855615, 10.251870, -2.723512, -6.213115},
    {2.855615, -10.251870, 2.723512, 6.213115},
    4,
  },
  {
    {-5.313044, 13.269231, -2.782305, -7.768707},
    {5.313044, -13.269231, 2.782305, 7.768707},
    4,
  },
  {
    {11.801262, 1.148760, -17.433962, 0.180570},
    {-11.801262, -1.148760, 17.433962, -0.180570},
    4,
  },
  {
    {1.497227, -9.720764, -2.467830, 7.950343},
    {-1.497227, 9.720764, 2.467830, -7.950343},
    4,
  },
  {
    {-31.571428, 0.015894, 0.836991, 1.867792},
    {31.571428, -0.015894, -0.836991, -1.867792},
    4,
  },
  {
    {-3.886878, -13.553719, -1.121011, -155.166672},
    {3.886878, 13.553719, 1.121011, 155.166672},
    4,
  },
  {
    {-17.115999, -3.164609, 12.694961, 4.335025},
    {17.115999, 3.164609, -12.694961, -4.335025},
    4,
  },
  {
    {7.390940, -5.761421, 19.584507, 0.320236},
    {-7.390940, 5.761421, -19.584507, -0.320236},
    4,
  },
};

int main()
{
  unsigned int ind;
  unsigned int jnd;

  for (ind = 0; ind < sizeof(tests) / sizeof(struct nega_test); ++ind) {
    switch (tests[ind].sz) {
      case 4:
        vec_nega4f(tests[ind].va);
        break;
      case 3:
        vec_nega3f(tests[ind].va);
        break;
      case 2:
        vec_nega2f(tests[ind].va);
        break;
      default:
        printf("error: ended up in default switch statement\n");
        return 2;
    }
    for (jnd = 0; jnd < tests[ind].sz; ++jnd) {
      if (!approx_equalf(tests[ind].vr[jnd],
                         tests[ind].va[jnd], APPROX_MAX_ERROR)) {
        printf("fail: [%u] vr[%u] %f != va[%u] %f\n",
                ind, jnd, tests[ind].vr[jnd], jnd, tests[ind].va[jnd]);
        return 1;
      }
      printf("[%u] vr[%u] %f ~ va[%u] %f\n",
              ind, jnd, tests[ind].vr[jnd], jnd, tests[ind].va[jnd]);
    }
    printf("--\n");
  }

  return 0;
} 
